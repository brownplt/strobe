<html>
<head>

<script type="text/javascript" src="prototype.js"></script>
<script type="text/javascript" src="data/jstrace.js"></script>

<title>JSTrace test</title>

<script type="text/javascript">
var pln = __typedjs(
  function (s) {
   s = s || "";
   var p = document.createTextNode(s);
   var rezdiv = document.getElementById("rezdiv");
   rezdiv.appendChild(p);
   rezdiv.appendChild(document.createElement('br'));
  },
  undefined, "pln", 0);

var simplefunc = __typedjs(
  function (arg, arg2) {
    return arg + arg2;
  },
  undefined, "simplefunc", 1);

var nestedfunc = __typedjs(
  function (a) {
    var increment = __typedjs(function (a) { return a + 1; },
                              arguments.callee, "increment", 0);
    a = increment(a); a = increment(a);
    return a;
  },
  undefined, "nestedfunc", 2);

var doublenest = __typedjs(
  function (a) {
    var tostr = __typedjs(
      function (b) {
        var add1 = __typedjs(
          function (c) {
            return c + 1;
          }, arguments.callee, "add1", 0);
        var addhi = __typedjs(
          function (c) {
            return c + "hi";
          }, arguments.callee, "addhi", 1);
        return addhi("" + add1(b));
      }, arguments.callee, "tostr", 0);
    return tostr(a);
  }, undefined, "doublenest", 3);

//anons:
/*function anonInner() {
  return (function(a) { return a+1; })(5);
}*/

var anonInner = __typedjs(
  function() {
    return (__typedjs(function(a) {
      return (__typedjs(function(b){return b;},arguments.callee,"",0))(a)+1; },
              arguments.callee, "", 0))(5);
  }, undefined, "anonInner", 4);


//---------------

function loader() {
  setTimeout(useFunction, 600);
}

function useFunction() {
  pln(new String("HAHAHA"));
  pln(simplefunc("1",2));
  pln(nestedfunc(5));
  pln(nestedfunc(6));
  pln(nestedfunc(7));
  pln(doublenest(10));
  pln(anonInner());
}

</script>
</head>

<body id="body" onload="loader()">
<div id="rezdiv"></div>
</body>

</html>
